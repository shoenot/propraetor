{% extends base_template %}

{% block title %}spare_parts.{% endblock %}

{% block content %}
<div class="detail-breadcrumb">
    <a href="{% url 'propraetor:dashboard' %}">~</a>
    <span> / </span>
    <span>spare_parts</span>
</div>

<!-- Info Notice -->
<div class="info-notice info-notice-muted">
    <svg class="info-notice-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
    </svg>
    <span>
        This inventory is a <strong>configuration &amp; metadata layer</strong>.
        Stock counts (<em>qty_available</em>) are auto-derived from
        <a href="{% url 'propraetor:components_list' %}?status=spare">components with status=spare</a>
        and kept in sync automatically. Use these entries to set reorder thresholds, notes, and storage locations.
    </span>
</div>

<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">total_parts</div>
        <div class="stat-value">{{ total_parts|default:0 }}</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">low_stock</div>
        <div class="stat-value">{{ low_stock_count|default:0 }}</div>
    </div>
</div>

<!-- Search and Filters -->
<div class="actions-bar">
    <div class="actions-left">
        <div class="search-box">
            <svg class="search-icon icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <input
                type="text"
                class="search-input"
                placeholder="search spare parts..."
                name="q"
                hx-get="{{ rows_url }}"
                hx-trigger="input changed delay:100ms, search"
                hx-target="#table-container-{{ table_id }}"
                hx-swap="innerHTML"
                hx-include="[name='status']">
            <span id="search-spinner" class="htmx-indicator">&#x27F3;</span>
        </div>
    </div>
    <div class="actions-right">
        <a href="{% url 'propraetor:components_list' %}?status=spare" class="btn btn-secondary">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
            </svg>
            view_spare_components
        </a>
        <a href="{% url 'propraetor:spare_part_create' %}" class="btn btn-secondary">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            add_inventory_entry
        </a>
        <button
            class="btn btn-secondary"
            hx-get="{% url 'propraetor:spare_parts_list' %}"
            hx-target="#table-container-{{ table_id }}"
            hx-swap="innerHTML"
            hx-include="[name='q'], [name='status']"
        >
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
            refresh
        </button>
    </div>
</div>

<!-- Table -->
<div class="table-container table-section" id="table-container-{{ table_id }}">
    {% include 'partials/reusable_table.html' %}
</div>
{% endblock %}